<!DOCTYPE html>
<html>
  <head>
    <title>Quick RPM Extension Test</title>
    <style>
      body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
      .step { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
      .code { background: #e0e0e0; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
      .success { color: green; font-weight: bold; }
      .error { color: red; font-weight: bold; }
    </style>
  </head>
  <body>
    <h1>ðŸš€ Quick RPM Extension Test</h1>

    <div class="step">
      <h3>Step 1: Load Extension</h3>
      <ol>
        <li>Open Chrome</li>
        <li>Go to: <code class="code">chrome://extensions/</code></li>
        <li>Enable "Developer mode" (top-right toggle)</li>
        <li>Click "Load unpacked"</li>
        <li>Select: <code class="code">packages/devtools-extension/</code></li>
        <li>You should see "React Performance Monitoring" in the list</li>
      </ol>
    </div>

    <div class="step">
      <h3>Step 2: Test Extension</h3>
      <ol>
        <li>Open a new Chrome tab</li>
        <li>Navigate to: <code class="code">packages/devtools-extension/test-cdn.html</code></li>
        <li>Press F12 to open DevTools</li>
        <li>Look for the "RPM" tab next to "Elements", "Console", etc.</li>
        <li>Click the "RPM" tab</li>
      </ol>
    </div>

    <div class="step">
      <h3>Step 3: Generate Performance Data</h3>
      <ol>
        <li>Click the buttons in the test app below</li>
        <li>Watch the RPM panel for live performance data</li>
        <li>You should see events appear in real-time</li>
      </ol>
    </div>

    <div class="step">
      <h3>Expected Results</h3>
      <ul>
        <li><span class="success">âœ“</span> Extension loads without errors</li>
        <li><span class="success">âœ“</span> "RPM" tab appears in DevTools</li>
        <li><span class="success">âœ“</span> Clicking buttons generates interaction events</li>
        <li><span class="success">âœ“</span> Timeline shows visual event bars</li>
        <li><span class="success">âœ“</span> Filter and export controls work</li>
      </ul>
    </div>

    <div class="step">
      <h3>Troubleshooting</h3>
      <ul>
        <li><span class="error">No RPM tab?</span> Refresh DevTools (Ctrl+Shift+I)</li>
        <li><span class="error">Extension not loading?</span> Check console for errors</li>
        <li><span class="error">No data?</span> Make sure buttons are clicked</li>
        <li><span class="error">Build errors?</span> Run <code class="code">npm run build</code> first</li>
      </ul>
    </div>

    <h2>Test App</h2>
    <div id="react-root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <script>
      const { useState } = React

      function TestApp() {
        const [count, setCount] = useState(0)
        const [items, setItems] = useState([])

        const loadData = async () => {
          const response = await fetch('https://jsonplaceholder.typicode.com/posts?_limit=3')
          const data = await response.json()
          setItems(data)
        }

        const doHeavyWork = () => {
          const start = performance.now()
          while (performance.now() - start < 50) {
            Math.sqrt(Math.random() * Number.MAX_SAFE_INTEGER)
          }
          console.log('Heavy work completed')
        }

        return React.createElement('div', { style: { padding: '20px', border: '1px solid #ddd', borderRadius: '8px' } },
          React.createElement('h3', null, 'Test React App'),
          React.createElement('p', null, 'Click buttons to generate performance events in the RPM DevTools panel.'),
          React.createElement('button', { onClick: () => setCount(c => c + 1) }, `Count: ${count}`),
          React.createElement('button', { onClick: loadData, style: { marginLeft: '10px' } }, 'Load API Data'),
          React.createElement('button', { onClick: doHeavyWork, style: { marginLeft: '10px' } }, 'Heavy Work'),
          items.length > 0 && React.createElement('ul', null,
            items.map(item => React.createElement('li', { key: item.id }, item.title.substring(0, 30) + '...'))
          )
        )
      }

      // Load RPM from CDN
      const script = document.createElement('script')
      script.src = 'https://unpkg.com/react-performance-monitoring@latest/dist/index.js'
      script.onload = () => {
        const { DevHUD } = window.ReactPerformanceMonitoring

        const app = React.createElement(TestApp)
        const wrappedApp = React.createElement(DevHUD, { forceEnabled: true }, app)

        ReactDOM.render(wrappedApp, document.getElementById('react-root'))
      }
      document.head.appendChild(script)
    </script>
  </body>
</html>